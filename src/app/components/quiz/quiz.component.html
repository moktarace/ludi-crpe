<div class="quiz-container" *ngIf="currentQuestion">
  <div class="quiz-header">
    <button class="exit-button" (click)="exitQuiz()">‚úï</button>
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
      </div>
      <span class="progress-text">{{ currentQuestionIndex + 1 }} / {{ questions.length }}</span>
    </div>
    <div class="score">‚≠ê {{ score }} XP</div>
  </div>

  <div class="quiz-content">
    <div class="question-card">
      <div class="question-header">
        <span class="question-type" [ngClass]="currentQuestion.type">
          <span *ngIf="currentQuestion.type === QuestionType.MULTIPLE_CHOICE">üìù QCM</span>
          <span *ngIf="currentQuestion.type === QuestionType.FREE_INPUT">‚úçÔ∏è R√©ponse libre</span>
          <span *ngIf="currentQuestion.type === QuestionType.TRUE_FALSE">‚úì/‚úó Vrai/Faux</span>
        </span>
        <span class="difficulty" [ngClass]="currentQuestion.difficulty">
          {{ currentQuestion.difficulty }}
        </span>
      </div>

      <h2 class="question-text">{{ currentQuestion.question }}</h2>

      <!-- QCM -->
      <div class="answers-grid" *ngIf="currentQuestion.type === QuestionType.MULTIPLE_CHOICE">
        <button 
          *ngFor="let answer of currentQuestion.answers"
          class="answer-button"
          [ngClass]="{
            'selected': selectedAnswer === answer.text && !showFeedback,
            'correct': showFeedback && answer.isCorrect,
            'incorrect': showFeedback && selectedAnswer === answer.text && !answer.isCorrect
          }"
          [disabled]="showFeedback"
          (click)="selectAnswer(answer.text)">
          {{ answer.text }}
        </button>
      </div>

      <!-- R√©ponse libre -->
      <div class="free-input" *ngIf="currentQuestion.type === QuestionType.FREE_INPUT">
        <input 
          type="text" 
          class="answer-input"
          [(ngModel)]="userAnswer"
          [disabled]="showFeedback"
          placeholder="Entrez votre r√©ponse..."
          (keyup.enter)="submitAnswer()">
      </div>

      <!-- Feedback -->
      <div class="feedback" *ngIf="showFeedback">
        <div class="feedback-message" [ngClass]="{ 'correct': isCorrect, 'incorrect': !isCorrect }">
          <span class="feedback-icon">
            {{ isCorrect ? '‚úì Correct !' : '‚úó Incorrect' }}
          </span>
          <p *ngIf="currentQuestion.explanation">{{ currentQuestion.explanation | mathNotation }}</p>
        </div>
      </div>

      <!-- Indices progressifs -->
      <div class="hints-section" *ngIf="currentQuestion.hints && currentQuestion.hints.length > 0 && !showFeedback">
        <button 
          class="hint-button" 
          (click)="showNextHint()"
          [disabled]="!hasMoreHints()">
          üí° Aide ({{ currentHintIndex }}/{{ currentQuestion.hints.length }})
        </button>
        <div class="hints-list" *ngIf="getVisibleHints().length > 0">
          <div class="hint" *ngFor="let hint of getVisibleHints(); let i = index">
            <span class="hint-number">Indice {{ i + 1 }}:</span> {{ hint | mathNotation }}
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button 
          *ngIf="!showFeedback"
          class="btn-submit"
          (click)="submitAnswer()">
          Valider
        </button>
        <button 
          *ngIf="showFeedback"
          class="btn-next"
          (click)="nextQuestion()">
          {{ currentQuestionIndex < questions.length - 1 ? 'Question suivante' : 'Terminer' }}
        </button>
      </div>
    </div>
  </div>
</div>
