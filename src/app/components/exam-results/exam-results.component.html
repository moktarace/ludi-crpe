<div class="results-container" *ngIf="result">
  <!-- En-tÃªte avec score -->
  <div class="results-header">
    <div class="score-card">
      <div class="score-emoji">{{ scoreEmoji }}</div>
      <div class="score-main" [style.color]="scoreColor">
        {{ result.score }}%
      </div>
      <div class="score-details">
        <p>{{ result.correctAnswers }} / {{ result.totalQuestions }} bonnes rÃ©ponses</p>
        <p>â±ï¸ Temps Ã©coulÃ© : {{ formattedTime }} / {{ result.duration }}:00</p>
      </div>
      
      <div class="score-message">
        <p *ngIf="result.score >= 90">Excellent ! Tu maÃ®trises parfaitement !</p>
        <p *ngIf="result.score >= 80 && result.score < 90">TrÃ¨s bien ! Continue comme Ã§a !</p>
        <p *ngIf="result.score >= 60 && result.score < 80">Bon travail ! Encore un peu d'entraÃ®nement.</p>
        <p *ngIf="result.score >= 40 && result.score < 60">Pas mal, mais tu peux faire mieux !</p>
        <p *ngIf="result.score < 40">Continue Ã  t'entraÃ®ner, tu vas progresser !</p>
      </div>
    </div>
  </div>

  <!-- Boutons d'action -->
  <div class="action-buttons">
    <button class="btn-show-corrections" (click)="toggleExplanations()">
      {{ showExplanations ? 'ğŸ“ Masquer les corrections' : 'ğŸ“– Voir les corrections dÃ©taillÃ©es' }}
    </button>
  </div>

  <!-- Liste des rÃ©ponses -->
  <div class="answers-list">
    <h2>ğŸ“‹ DÃ©tail de tes rÃ©ponses</h2>
    
    <div class="answer-item" *ngFor="let answer of result.answers; let i = index">
      <div class="answer-header">
        <span class="answer-number">Question {{ i + 1 }}</span>
        <span class="answer-status" [class.correct]="answer.isCorrect" [class.incorrect]="!answer.isCorrect">
          {{ answer.isCorrect ? 'âœ… Correct' : 'âŒ Incorrect' }}
        </span>
        <span class="answer-time">â±ï¸ {{ answer.timeTaken }}s</span>
      </div>

      <div class="answer-content">
        <div class="question-text" [innerHTML]="answer.question.question | mathNotation"></div>

        <!-- RÃ©ponse de l'utilisateur -->
        <div class="user-answer">
          <strong>Ta rÃ©ponse :</strong>
          <span *ngIf="answer.question.type === 'multiple_choice'">
            {{ getAnswerLabel(answer.userAnswer) }}
            <span *ngIf="answer.userAnswer !== null">
              - {{ getUserAnswerText(answer.userAnswer, answer.question.answers) }}
            </span>
          </span>
          <span *ngIf="answer.question.type === 'free_input'">
            {{ answer.userAnswer }}
          </span>
        </div>

        <!-- Bonne rÃ©ponse si incorrect -->
        <div class="correct-answer" *ngIf="!answer.isCorrect">
          <strong>Bonne rÃ©ponse :</strong>
          <span *ngIf="answer.question.type === 'multiple_choice'">
            {{ getAnswerLabel(getCorrectAnswerIndex(answer.question.answers)) }}
            - {{ getCorrectAnswerText(answer.question.answers) }}
          </span>
          <span *ngIf="answer.question.type === 'free_input'">
            {{ answer.question.correctAnswer }}
          </span>
        </div>

        <!-- Explication dÃ©taillÃ©e -->
        <div class="explanation-section" *ngIf="showExplanations">
          <div class="explanation-box">
            <h4>ğŸ“– Explication :</h4>
            <div [innerHTML]="answer.question.explanation | mathNotation"></div>
          </div>

          <!-- Explication "vie rÃ©elle" si disponible -->
          <div class="real-life-explanation-box" *ngIf="answer.question.realLifeExplanation">
            <h4>ğŸŒ Dans la vraie vie :</h4>
            <div [innerHTML]="answer.question.realLifeExplanation | mathNotation"></div>
          </div>

          <!-- Indices -->
          <div class="hints-box" *ngIf="answer.question.hints && answer.question.hints.length > 0">
            <h4>ğŸ’¡ Indices :</h4>
            <ul>
              <li *ngFor="let hint of answer.question.hints" [innerHTML]="hint | mathNotation"></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Boutons de navigation -->
  <div class="navigation-buttons">
    <button class="btn-retry" (click)="retryExam()">
      ğŸ”„ Refaire un examen
    </button>
    <button class="btn-home" (click)="goHome()">
      ğŸ  Retour Ã  l'accueil
    </button>
  </div>
</div>
